\chapter{Teorema de Nash-Kuiper $C^1$}\label{chap:capitol_nash}

Al final del capítol anterior hem vist que és possible trobar immersions i encabiments isomètrics que resultarien impossibles en altres condicions si no imposem que aquestes aplicacions siguin de classe $C^\infty$. Aquest capítol està dedicat a una formalització d'aquesta idea mitjançant el teorema de Nash-Kuiper. El cos principal del capítol consistirà en la demostració dels teoremes originals tals com els va demostrar \cite{nash1954}, de manera que veurem que si una varietat Riemanniana es pot encabir de manera curta en un espai euclidià de dimensió $k\ge n+2$, aleshores es pot modificar aquesta aplicació per obtenir-ne una d'isomètrica tan propera com vulguem, però amb regularitat $C^1$. Al final del capítol veurem una millora clau en la demostració, comentant breument l'article de Nicolaas H. Kuiper, \cite{kuiper1955}, que demostra el mateix resultat per a immersions $C^\infty$ en espais de dimensió $n+1$. A més, farem un breu comentari de com el mètode de Nash va inspirar Mikhaïl Gromov en el desenvolupament de la integració convexa. 

Cal destacar, abans de començar, que el resultat de Nash és molt sorprenent i contraintuïtiu. En efecte, el gran èmfasi en la geometria diferencial i riemanniana de varietats $C^\infty$ havia imposat una noció de la rigidesa de les varietats riemannianes pel que fa als encabiments isomètrics que no és cert en el cas $C^1$. Abans de l'article de Nash, s'havia demostrat l'existència d'encabiments isomètrics en espais euclidians de l'anomenada \textbf{dimensió de Janet}, $s_n = \frac{n(n+1)}{2}$ per varietats analítiques, una dimensió que pot arribar a ser molt més alta que la del teorema de Whitney per encabiments no isomètrics, $2n$. La dràstica baixada de regularitat és \say{el preu a pagar} per trencar aquesta rigidesa.
\\

\subsection{Definicions preliminars}
\begin{defi}
    Diem que una varietat Riemanniana $M$ és \textbf{tancada} si és compacta, i diem que és \textbf{oberta} si cap dels seus components connexos és tancat.
\end{defi}

La imatge d'una varietat tancada per un encabiment o immersió contínua és compacta. Si la imatge és una subvarietat de $\mathbb R^k$, aleshores és tancada i acotada. Ara bé, per a una varietat oberta la imatge no és necessàriament compacta. En aquest cas, és possible definir el \textbf{conjunt límit} de la imatge, que és el conjunt de punts de $\mathbb R^k$ tals que són el límit de successions de punts de la imatge, però que no pertanyen a la imatge. 

\begin{ex}
    El conjunt límit de l'encabiment per la inclusió $\imath$ de la bola oberta $\mathbb B^2$ en $\mathbb R^2$ és el cercle $\mathbb S^1$.
\end{ex}

\section{Enunciat dels teoremes}

\begin{teo}
    Qualsevol varietat Riemanniana tancada de dimensió $n$ té un encabiment isomètric $C^1$ en $\mathbb R^{2n}$.
\end{teo}
\begin{teo}
    Qualsevol varietat Riemanniana de dimensió $n$ té una immersió isomètrica $C^1$ en $\mathbb R^{2n}$ i un encabiment isomètric $C^1$ en $\mathbb R^{2n+1}$.
\end{teo}
\begin{teo}
    Si una varietat Riemanniana tancada de dimensió $n$ té una immersió o encabiment $C^\infty$ en $\mathbb R^{k}$ amb $k\ge n+2$, aleshores també té una immersió o encabiment, respectivament, isomètric en $\mathbb R^{k}$.
\end{teo}
\begin{teo}
    Si una varietat Riemanniana oberta de dimensió $n$ té una immersió o encabiment $C^\infty$ curta en $\mathbb R^{k}$ amb $k\ge n+2$ que no se solapa amb el seu conjunt límit (si aquest existeix), aleshores també té una immersió o encabiment, respectivament, isomètric en $\mathbb R^{k}$ del mateix tipus.
\end{teo}
\section{Demostració}
Sigui $(M,g)$ una varietat diferenciable Riemanniana de dimensió $n$, amb la seva mètrica intrínseca donada per un tensor mètric $g_{ij}$. Volem trobar una immersió isomètrica d'aquesta varietat $M$ en algun espai euclidià.

Suposem que tenim una immersió $f$ de $M$ en un espai euclidià $\mathbb R^k$, de manera que per un punt amb coordenades locals $\set{x^i}$ de $M$, les coordenades de la seva imatge en $\mathbb R^k$ són $\set{z^\alpha(x^1, \dots, x^n)}$,
\begin{align*}
    f:M&\to \mathbb R^k, \\
    \set{x^i} &\mapsto \set{z^\alpha(x^1, \dots, x^n)}. 
\end{align*}
Aleshores, la mètrica induïda en $M$ és donada pel tensor mètric
\begin{equation*}
    h_{ij} = \sum_\alpha \frac{\partial z^\alpha}{\partial x^i}\frac{\partial z^\alpha}{\partial x^j}.
\end{equation*}
El nostre objectiu és equivalent a aconseguir que $h_{ij}=g_{ij}.$

Per tal de començar la demostració, el primer que necessitarem serà que la immersió original $f$ que sigui de classe $C^\infty$ i \textit{curta}.
\begin{defi}
    Diem que una immersió $f:M\to \mathbb R^k$ és \textbf{curta} si l'error mètric és definit positiu, on l'\textbf{error mètric} és el tensor diferència $\delta_{ij} = g_{ij} - h_{ij}$.
\end{defi}
El més important d'aquesta definició és que, si $f$ és curta, els vectors tangents a $M$ mai s'allarguen sota $f$. És fàcil trobar immersions d'aquesta mena per a varietats tancades, mentre que per varietats obertes cal utilitzar un mecanisme més complicat. Discutim la manera d'obtenir aquestes immersions a la secció \ref{sec:encabiment_inicial}.

Un cop trobada aquesta immersió curta, l'estructura de la demostració dels teoremes de Nash consisteix en fer una successió de pertorbacions de $f$ que disminueixen l'error mètric progressivament fins a convergir en una immersió isomètrica. En general, el procés de pertorbació es divideix en \textbf{etapes} (en anglès, \textit{stages}), i a cada etapa es divideix en \textbf{passos} (en anglès, \textit{steps}). Així, la primera etapa prendrà la nostra immersió curta $f$ i en retornarà una $f_1$ amb un error mètric com a molt la meitat del de $f$, que serà també $C^\infty$ i curta. Aquesta $f_1$ serà millorada en la segona etapa, i així successivament.

La manera en què l'error mètric haurà de disminuir en cada etapa és la següent: si en la primera immersió, l'error mètric és 
\begin{equation*}
    \delta_{ij} = g_{ij}-h_{ij},
\end{equation*}
en la segona etapa, l'error mètric serà
\begin{equation*}
    \overline\delta_{ij} = g_{ij}-\overline{h}_{ij}\approx \frac12\delta_{ij},
\end{equation*}
on $\overline{h}_{ij}$ és la mètrica induïda per $f_1$. Aquest error mètric anirà disminuint geomètricament després de cada etapa, i en el límit obtindrem una immersió isomètrica.

En cada etapa individual, el procés de pertorbació es divideix en passos. Cada pas afectarà només un cert entorn de $M$, però s'hauran de dur a terme l'un rere l'altre, no simultàniament. Per tal de fer-ho, cal prendre un recobriment localment finit de $M$ per conjunts compactes $\set{N_p}_p$. La construcció d'aquest recobriment és possible, com hem vist al lema \ref{lema:paracompact}. Sigui $\set{\varphi_p}_p$ una partició de la unitat subordinada a $\set{N_p}_p$. 

En cada entorn $N_p$, voldrem que l'error mètric $\delta_{ij}$ sigui reduït en $\frac12\varphi_p\delta_{ij}$ després d'una etapa. Per fer-ho, necessitem aproximar $\delta_{ij}$ per un tensor de classe $C^\infty$ i definit positiu $\beta_{ij}$. Per tal de fer servir aquest $\beta_{ij}$ per reduir l'error mètric, necessitem el següent resultat:
\begin{lema}
    Sigui $\beta_{ij}$ un tensor de classe $C^\infty$ i definit positiu, i sigui $\varphi_p$ la funció de la partició de la unitat associada a $N_p$. Aleshores, es poden trobar funcions no-negatives $a_\nu$ de classe $C^\infty$ i un nombre finit de funcions lineals $\psi^\nu = \psi^\nu(x^1, \dots, x^n)$ tals que
\begin{equation}\label{eq:lema_descomp}
    \frac12\varphi_p\beta_{ij} = \sum_\nu a_\nu \left(\frac{\partial\psi^\nu}{\partial x^i}\right)\left(\frac{\partial\psi^\nu}{\partial x^j}\right),
\end{equation}
\end{lema}
\begin{obs}
    Cal remarcar que aquest lema només és cert si $\beta_{ij}$ és definit positiu, i que el nombre de termes del sumatori és finit.
\end{obs}
{\color{black}\textit{Prova}.
El conjunt de les matrius simètriques definides positives de rang $n$ és un con de dimensió $\frac12n(n+1)$. És possible cobrir aquest con amb conjunts simplicials oberts, de tal manera que cada punt del con estigui cobert per, com a molt, un nombre $W$ d'aquests entorns, on $W$ depèn només de $n$. 

Una matriu qualsevol representada per un punt interior d'un símplex és combinació lineal de les matrius que representen els vèrtexs del símplex. Podem posar
$$\begin{aligned}
    &C_{1,1}; \quad C_{1,2}; \quad C_{1,3}; \quad \dots\\
    &C_{2,1}; \quad C_{2,2}; \quad C_{2,3}; \quad \dots\\
    &\vdots\\
    &C_{q,1}; \quad C_{q,2}; \quad C_{q,3}; \quad \dots
\end{aligned}$$
els coeficients per $q$ representacions diferents d'una matriu del con que pertany a l'interior de $q$ símplexs diferents. 
Ara podem escriure uns altres coeficients
$$ C_{\mu,\nu}^* = \frac{C_{\mu,\nu} \exp\set{-\sum_\sigma 1/C_{\mu,\sigma}}}{\sum_{\rho}\exp\set{-\sum_\sigma 1/C_{\rho,\sigma}}}, $$ on un terme del sumatori al numerador o denominador es considera zero si el corresponent $C_{\mu,\nu}$ és zero, o si algun $C_{\rho,\sigma}$ és zero o no definit. 
Observem que aquests coeficients són $C^\infty$ com a funcions de la matriu que representen. A més, per cada matriu, com a molt $W[\frac12n(n+1)+1]$ coeficients $C_{\mu,\nu}^*$ són no-nuls.

Si ara considerem que $\beta_{ij}$ defineix una aplicació de classe $C^\infty$ de $N_p$ al con, aleshores podem escriure 
\begin{equation}\label{eq:beta_con}
    \beta_{ij} = \sum_{\mu,\nu}C_{\mu,\nu}^*M_{(\mu,\nu)ij}
\end{equation}
on $M_{(\mu,\nu)ij}$ són les diferents matrius que representen els vèrtexs dels símplexs. Ara, per cada matriu $M_{(\mu,\nu)ij}$ obtenim $n$ autovectors unitaris ortogonals $\set{V_r}$ i els seus autovalors $\set{v_r}$.

Si $\psi_r$ és per cada $r$ la funció lineal dels paràmetres locals pels quals $\sqrt{v_r}V_r$ és el vector gradient, tenim que
\begin{equation*}
    M_{(\mu,\nu)ij} = \sum_{r}\frac{\partial\psi_r}{\partial x^i}\frac{\partial\psi_r}{\partial x^j}
\end{equation*}
i, substituint en l'equació \eqref{eq:beta_con}, tenim que
\begin{equation*}
    \beta_{ij} = \sum_{r}\sum_{\mu,\nu}C_{\mu,\nu}^*M_{(\mu,\nu)ij}\frac{\partial\psi_r}{\partial x^i}\frac{\partial\psi_r}{\partial x^j}
\end{equation*}
i, agrupant termes en $a_\nu$, obtenim el resultat.\qed
}

\subsection{La pertorbació en un pas}
En el pas associat a $N_p$ d'una etapa donada, caldrà fer una pertorbació de la immersió curta obtinguda anteriorment. Per fer-ho, considerem dos camps vectorials unitaris ortogonals entre ells i a la immersió en l'entorn $N_p$, representats per funcions de classe $C^\infty$, $\zeta^\alpha$ i $\eta^\alpha$. 
És a dir, les coordenades dels camps vectorials normals $\zeta$ i $\eta$ compleixen les següents propietats:
\begin{align*}
    \sum_\alpha (\zeta^\alpha)^2 = 1, \\
    \sum_\alpha (\eta^\alpha)^2 = 1, \\
    \sum_\alpha \zeta^\alpha\eta^\alpha = 0, \\
    \sum_\alpha \zeta^\alpha\frac{\partial z^\alpha}{\partial x^i} = \sum_\alpha \eta^\alpha\frac{\partial z^\alpha}{\partial x^i} = 0.
\end{align*}

Amb aquests camps vectorials, la pertorbació trobada per Nash de la immersió curta $z^\alpha$ en un pas a l'entorn $N_p$ és
\begin{equation}\label{eq:pertorbacio}
    \boxed{\overline{z}^\alpha = z^\alpha + \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu) + \eta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\sin(\lambda \psi^\nu)}
\end{equation}
on $\lambda$ és una constant positiva tan gran com vulguem.

Ara cal veure que el canvi mètric $\sum_\alpha\frac{\partial\overline{z}^\alpha}{\partial x^i}\frac{\partial\overline{z}^\alpha}{\partial x^j}-\sum_\alpha\frac{\partial z^\alpha}{\partial x^i}\frac{\partial z^\alpha}{\partial x^j}$ és aproximadament igual al terme $\nu$ del sumatori de l'equació \eqref{eq:lema_descomp}.

\begin{prop}\label{prop:mida_pertorbacio}
    El canvi mètric a l'entorn $N_p$ en el pas associat a $a_\nu$ i $\psi^\nu$ donat per l'equació \eqref{eq:pertorbacio} compleix
    \begin{equation}\label{eq:pertorbacio_cota}
        \sum_\alpha\frac{\partial\overline{z}^\alpha}{\partial x^i}\frac{\partial\overline{z}^\alpha}{\partial x^j}-\sum_\alpha\frac{\partial z^\alpha}{\partial x^i}\frac{\partial z^\alpha}{\partial x^j} =  a_\nu \frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + O\left(\frac1\lambda\right)
    \end{equation}
\end{prop}

{\color{black}\textit{Prova}. Desenvolupant les derivades parcials i cancel·lant els termes que apareixen en ambdós costats, tenim
\begin{align}\label{eq:pertorbacio_descomp}
    \nonumber\sum_\alpha\frac{\partial\overline{z}^\alpha}{\partial x^i}\frac{\partial\overline{z}^\alpha}{\partial x^j}-\sum_\alpha\frac{\partial z^\alpha}{\partial x^i}\frac{\partial z^\alpha}{\partial x^j}
    =
    \sum_{\alpha}\Bigg[ &\frac{\partial}{\partial x^i}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right) \frac{\partial}{\partial x^j}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right) +
    \\
    &+ \frac{\partial}{\partial x^i}\left( \eta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\sin(\lambda \psi^\nu)\right) \frac{\partial}{\partial x^j}\left( \eta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\sin(\lambda \psi^\nu)\right)
    \Bigg]
\end{align}
Observem que cada en terme del sumatori apareixen quatre derivades similars, canviant $\zeta^\alpha$ per $\eta^\alpha$ i $\cos$ per $\sin$, així com $i$ per $j$. Podem considerar una sola d'aquestes, per exemple $\frac{\partial}{\partial x^i}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right)$. Desenvolupant-la, tenim
\begin{align*}
    \frac{\partial}{\partial x^i}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right)
    =&
    \left(\frac{\partial \zeta^\alpha}{\partial x^i} \right)\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu) 
    \\&+ 
    \zeta^\alpha\frac{1}{\lambda}\left(\frac{\partial}{\partial x^i}\sqrt{a_\nu}\right) \cos(\lambda \psi^\nu)
    \\&-
    \zeta^\alpha\sqrt{a_\nu}\sin(\lambda \psi^\nu)\frac{\partial\psi^\nu}{\partial x^i}.
\end{align*}
Observem que els dos primers termes d'aquesta suma són $O\left(\frac1\lambda\right)$, de manera que es pot prendre $\lambda$ prou gran per fer-los tan petits com vulguem. Així, 
\begin{equation*}
    \frac{\partial}{\partial x^i}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right) = -
    \zeta^\alpha\sqrt{a_\nu}\sin(\lambda \psi^\nu)\frac{\partial\psi^\nu}{\partial x^i} + O\left(\frac1\lambda\right).
\end{equation*}
El producte d'aquest terme amb la derivada respecte de $x^j$ en l'equació \eqref{eq:pertorbacio_descomp} és, per tant,
\begin{equation*}
    \frac{\partial}{\partial x^i}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right) \frac{\partial}{\partial x^j}\left( \zeta^\alpha\frac{\sqrt{a_\nu}}{\lambda}\cos(\lambda \psi^\nu)\right) = 
    (\zeta^\alpha)^2{a_\nu}\sin^2(\lambda \psi^\nu)\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + O\left(\frac1\lambda\right).
\end{equation*}
Sumant aquest resultat amb el corresponent a $\eta^\alpha$, obtenim que el terme $\alpha$ del sumatori de l'equació \eqref{eq:pertorbacio_descomp} és
\begin{align*}
    &(\zeta^\alpha)^2{a_\nu}\sin^2(\lambda \psi^\nu)\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + (\eta^\alpha)^2{a_\nu}\cos^2(\lambda \psi^\nu)\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + O\left(\frac1\lambda\right)
    \\&=
    ((\zeta^\alpha)^2\sin^2(\lambda \psi^\nu) + (\eta^\alpha)^2\cos^2(\lambda \psi^\nu)) a_\nu\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + O\left(\frac1\lambda\right).
\end{align*}
De manera que 
\begin{align*}
    \sum_\alpha\frac{\partial\overline{z}^\alpha}{\partial x^i}\frac{\partial\overline{z}^\alpha}{\partial x^j}-\sum_\alpha&\frac{\partial z^\alpha}{\partial x^i}\frac{\partial z^\alpha}{\partial x^j}=\\
    &=
    \sum_{\alpha}\Bigg[((\zeta^\alpha)^2\sin^2(\lambda \psi^\nu) + (\eta^\alpha)^2\cos^2(\lambda \psi^\nu)) a_\nu\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j}
    + O\left(\frac1\lambda\right) \Bigg]
    \\
    &=a_\nu\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j}\left( \sin^2(\lambda \psi^\nu)\sum_\alpha(\zeta^\alpha)^2 + \cos^2(\lambda \psi^\nu)\sum_\alpha(\eta^\alpha)^2\right) + O\left(\frac1\lambda\right)
    \\&=
    a_\nu\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j} + O\left(\frac1\lambda\right),
\end{align*}
on per a la darrera igualtat hem usat que $\sum_\alpha(\zeta^\alpha)^2 = \sum_\alpha(\eta^\alpha)^2 = 1$.\qed
}

Amb aquesta última proposició s'ha demostrat que la pertorbació indueix un canvi mètric molt proper al que volem, amb un error d'ordre $O\left(\frac1\lambda\right)$. De la mateixa manera, observem que la pertorbació en un pas, \eqref{eq:pertorbacio}, és també d'ordre $O\left(\frac1\lambda\right)$. 

A continuació, volem veure quin és el canvi en les primeres derivades després d'una etapa del procés en un entorn $N_p$. És a dir, volem aproximar l'efecte de totes les pertorbacions associades a cada pas de l'etapa. Per fer-ho, primer notem que el canvi en les primeres derivades associat al pas $\nu$ és el següent:
\begin{equation}\label{eq:primera_derivada_cota}
    \left| \frac{\partial\overline{z}^\alpha}{\partial x^i} - \frac{\partial z^\alpha}{\partial x^i} \right| \le 2\sqrt{a_\nu}\left| \frac{\partial\psi^\nu}{\partial x^i} \right| + O\left(\frac1\lambda\right).
\end{equation}
\begin{prop}\label{prop:primer_derivada}
    El canvi en les primeres derivades associat a una etapa del procés en un entorn $N_p$ és
    \begin{align}\label{eq:moltes_lambdes}
        \nonumber\Bigg| \left(\frac{\partial{z}^\alpha}{\partial x^i} \right)_{\textrm{abans}}- &\left(\frac{\partial{z}^\alpha}{\partial x^i} \right)_{\textrm{després}} \Bigg| \\
        &\le 2\sqrt{K\beta_{ii}} + O\left(\frac1{\lambda_1}\right) + O\left(\frac1{\lambda_2}\right) + \cdots + O\left(\frac1{\lambda_\nu}\right) + \cdots,
    \end{align}
    on $K$ és una constant que depèn només de la dimensió $n$ de la varietat i les diferents $\lambda_\nu$ són els paràmetres de les pertorbacions.
\end{prop}
{
\color{black}\textit{Prova}.
Considerem l'element $i$ de la diagonal de les matrius de l'equació \eqref{eq:lema_descomp}:
\begin{equation*}
    \frac12\varphi_p\beta_{ii} = \sum_\nu a_\nu\left(\frac{\partial\psi^\nu}{\partial x^i}\right)^2 = \sum_\nu \left(\sqrt{a_\nu}\left|\frac{\partial\psi^\nu}{\partial x^i}\right|\right)^2.
\end{equation*}
Recordem de la prova del lema \eqref{eq:lema_descomp} que hi ha com a molt $M = W[\frac12n(n+1)+1]$ coeficients no nuls del sumatori, on $W$ és una constant que només depèn de la dimensió $n$ de la varietat. Així doncs, per la desigualtat de Cauchy-Schwarz,
\begin{align*}
    \sum_\nu \sqrt{a_\nu}\left|\frac{\partial\psi^\nu}{\partial x^i}\right| 
    \le 
    \left(M\frac12\varphi_p\beta_{ii}\right)^{\frac12}
    \le
    \left(K\varphi_p\beta_{ii}\right)^{\frac12}
    \le
    \sqrt{\left(K\beta_{ii}\right)}.
\end{align*}
Combinant aquest resultat amb la desigualtat \eqref{eq:primera_derivada_cota}, obtenim que el canvi en les primeres derivades associat a una etapa del procés en un entorn $N_p$ és
\begin{equation*}
    \left| \frac{\partial\overline{z}^\alpha}{\partial x^i} - \frac{\partial z^\alpha}{\partial x^i} \right| \le 2\sqrt{K\beta_{ii}} + O\left(\frac1{\lambda_1}\right) + O\left(\frac1{\lambda_2}\right) + \cdots + O\left(\frac1{\lambda_\nu}\right) + \cdots.
\end{equation*}
\qed
}
\subsection{Convergència dels passos en una etapa}
A continuació ens interessa veure quines són les constants $\set{\lambda_\nu}$ necessàries en els diferents passos d'una etapa per tal que el procés convergeixi tal com desitgem.
\begin{defi}
    Sigui $N_p$ un entorn del recobriment de $M$, i considerem el pas $\nu$ d'una etapa donada.
\end{defi}
\begin{itemize}\label{def: B1 B2 B3}
    \item \textit{Anomenem $B_1$ l'error d'ordre $O\left(\frac1{\lambda}\right)$ màxim permès en l'aproximació del canvi mètric per $a_\nu\left(\frac{\partial\psi^\nu}{\partial x^i}\right)\left(\frac{\partial\psi^\nu}{\partial x^j}\right)$ en l'equació \eqref{eq:pertorbacio_cota}, per tots els parells $(i,j)$ i tots els punts de l'entorn $N_p$.}
    \item \textit{Anomenem $B_2$ l'error d'ordre $O\left(\frac1{\lambda}\right)$ màxim permès en l'aproximació del canvi de les primeres derivades en la desigualtat \eqref{eq:primera_derivada_cota}, per tots els punts de l'entorn $N_p$.}
    \item \textit{Anomenem $B_3$ la cota superior permesa del canvi $\overline{z}^\alpha - z^\alpha$ en $N_p$.}
\end{itemize}
\begin{obs}
    Es pot trobar una pertorbació que compleixi les condicions anteriors per a qualsevol $B_1$, $B_2$ i $B_3$ donats, ja que tots tres disminueixen quan $\lambda$ augmenta i aquesta pot ser presa arbitràriament gran.
\end{obs}

Recordem que l'efecte desitjat després d'una etapa és prendre una mètrica induïda $h_{ij}$ i trobar-ne una $h'_{ij}$ que redueixi a la meitat l'error mètric $\delta_{ij}$. És a dir, la nova mètrica $h'_{ij}$ ha de complir
\begin{equation*}
    h'_{ij} \approx h_{ij} + \frac12\delta_{ij},
\end{equation*}
que també podem escriure com 
\begin{equation*}
    h'_{ij} = g_{ij} - \frac12\delta_{ij} + e_{ij},
\end{equation*}
on $e_{ij}$ és el terme de l'error de l'aproximació. Així, la diferència entre la mètrica de la nova immersió i la original és
\begin{equation}\label{eq:delta_prima}
    \delta_{ij}' = \frac12\delta_{ij} - e_{ij}.
\end{equation}
A continuació, volem assegurar que $\delta_{ij}'$ sigui definit positiu, i que el tensor d'error $e_{ij}$ sigui prou petit per permetre la convergència del procés.
\begin{nota}
    Per un tensor donat $T_{ij}$ en un entorn $N_p$, escrivim $|T_{ij}|_{N_p}$ per denotar el màxim dels valors absoluts dels components de $T_{ij}$ en $N_p$. Aquesta és una bona aproximació de la mida del tensor $T_{ij}$ en $N_p$.
\end{nota}
\begin{prop}\label{prop:dos de tres}
    Sigui $N_p$ un entorn de $M$. En una etapa donada del procés, existeix una successió $\set{B_{1\nu}}_{\nu}$, on $B_{1\nu}$ és el $B_1$ de la definició \ref{def: B1 B2 B3} al pas $\nu$, tal que, després de fer tots els passos en $N_p$
\end{prop}
\begin{itemize}
    \item \textit{$\delta_{ij}'$ és definit positiu en $N_p$.}
    \item \textit{$e_{ij}$ és prou petit per assegurar que el procés convergeix després de fer totes les etapes.}
    \item \textit{La convergència és tal que la mida de $\delta_{ij}'$ és com a molt $2/3$ de la mida de $\delta_{ij}$ després de cada etapa. }
\end{itemize}
\begin{obs}
    Aquest resultat confirma que el procés de correcció de la mètrica convergeix, de tal manera que la mètrica induïda per la successió d'immersions s'aproxima a la mètrica intrínseca $g_{ij}$.
    La convergència de la immersió com a tal es tractarà més endavant. 
\end{obs}
{\color{black} \textit{Prova.} 
En $N_p$, sempre es pot trobar una constant real $\varepsilon_p>0$ tal que, si imposem 
\begin{equation}\label{eq:epsilon_p}
    |e_{ij}|_{N_p} \le \varepsilon_p,
\end{equation}
aleshores $\delta_{ij}'= \delta_{ij} - e_{ij}$ és definit positiu.

Si també imposem que, després d'una etapa,
\begin{equation}\label{eq:e_cota}
    \max|e_{ij}|_{N_p} \le \frac16\min|\delta_{ij}|_{N_p},
\end{equation}
podem prendre l'equació \eqref{eq:delta_prima} i veure que
\begin{align}\label{eq:delta_prima_cota}
    \nonumber\max|\delta_{ij}'|_{N_p} = \max\left|\frac12\delta_{ij} - e_{ij}\right|_{N_p} \le \max\left|\frac12\delta_{ij}\right|_{N_p} + \max|e_{ij}|_{N_p} \\
    \le \frac12\max|\delta_{ij}|_{N_p} + \frac16\min|\delta_{ij}|_{N_p} \le \frac23\max|\delta_{ij}|_{N_p}.
\end{align}
Amb això queda demostrat que es pot escollir $e_{ij}$ tal que la mida de $\delta_{ij}'$ sigui com a molt $2/3$ de la mida de $\delta_{ij}$ després de cada etapa. Així, és clar que la diferència entre la mètrica de la immersió i $g_{ij}$ convergeix a $0$ en el límit.

Hem obtingut dues restriccions a la mida de $e_{ij}$ que cal complir, les desigualtats \eqref{eq:epsilon_p} i \eqref{eq:e_cota}. Ara cal relacionar-les amb els passos de l'etapa, per tal d'obtenir la successió $\set{B_{1\nu}}_{\nu}$ desitjada. 

Primer de tot, recordem que els entorns $N_p$ poden intersecar amb altres entorns $N_q$. Així, els canvis que fem en $N_p$ poden afectar a $N_q$. Afortunadament, el nombre d'entorns que intersequen cada $N_p$ és finit. Si $N_p$ interseca amb un nombre $\sigma$ d'entorns $N_q$, incloent $N_p$ mateix, aleshores podem prendre les restriccions de $N_p$, dividir-les per $\sigma$, i imposar-les a tots els $N_q$. Sigui $\varepsilon_p^*$ el mínim de totes aquestes restriccions sobre l'error de $N_p$.

Notem que hi ha dues fonts de l'error en $N_p$: el primer és l'aproximació preliminar de $\delta_{ij}$ pel tensor $\beta_{ij}$, i el segon és l'error acumulat pels passos individuals. Per tant, imposant $|\delta_{ij}-\beta_{ij}|_{N_p} \le \varepsilon_p^*$ obtenim 
\begin{equation}\label{eq:error_aproximacio}
    \left|\frac12\varphi_p\delta_{ij}-\frac12\varphi_p\beta_{ij}\right|_{N_p} \le \frac12\varepsilon_p^*.
\end{equation}
Ens resta $\frac12\varepsilon_p^*$
per a l'error dels passos individuals, que podem assignar de la següent manera:
\begin{equation}\label{eq:error_passos}
    B_{1\nu} \le \frac{1}{2^{\nu+1}}\varepsilon_p^*.
\end{equation}
De manera que l'error total obtingut sumant les cotes \eqref{eq:error_aproximacio} i \eqref{eq:error_passos} és menor que
\begin{equation*}
    \frac12\varepsilon_p^* + \sum_{\nu=1}^\infty \frac1{2^{\nu+1}}\varepsilon_p^* = \varepsilon_p^*.
\end{equation*}
Així, obtenim la successió $\set{B_{1\nu}}_{\nu}$ desitjada.
\qed
}
\subsubsection{Realitzabilitat dels passos}
Per tal que els passos siguin realitzables, només cal tenir una immersió $C^\infty$. Això és cert sempre que la mètrica induïda sigui definida positiva i les immersions siguin $C^\infty$. Totes les funcions utilitzades en el procés són $C^\infty$, de manera que només cal veure que la mètrica induïda és definida positiva.

Procedim per inducció. Suposem que cada pas pren una immersió que produeix una mètrica induïda definida positiva, i augmenta la mètrica induïda en $a_\nu\left(\frac{\partial\psi^\nu}{\partial x^i}\frac{\partial\psi^\nu}{\partial x^j}\right)$. Així, la mètrica induïda és definida positiva. Aquest augment és un tensor no-negatiu, i l'error és $O\left(\frac1{\lambda}\right)$, de manera que per una $\lambda$ prou gran, ens podem assegurar que la mètrica induïda és definida positiva.

\subsection{Organització general}
% {\color{blue} Aquest apartat haurem de mirar de moure'l a un lloc més adequat, potser. }

\begin{itemize}
    \item El procés es divideix en una sèrie \textbf{d'etapes}. Cada una d'elles és igual que la resta, però la primera necessita una immersió $f$ de classe $C^\infty$ curta. Després de cada etapa, la nova immersió segueix sent $C^\infty$ i curta, però l'error mètric és com a molt $2/3$ de l'error de la immersió de l'etapa anterior.
    \item S'escull un recobriment localment finit de $M$ per conjunts tancats $N_p$. És a dir, tal que cada punt de $M$ pertany a, com a molt, un nombre finit de conjunts $N_p$.
    \item Cada etapa es divideix en un nombre finit de \textbf{passos}. Primer, la correcció es divideix entre tots els conjunts $N_p$ amb unes funcions pes $\varphi_p$. Aleshores es divideix la correcció de cada $N_p$ en un nombre finit de passos, en l'equació \eqref{eq:lema_descomp}
    \item Els passos s'han de realitzar un rere l'altre. L'ordre concret no importa, però s'ha d'escollir un ordre i seguir-lo. En varietats obertes, el nombre de passos és infinit, però en cada entorn compacte el nombre de passos és finit.
\end{itemize}

\subsection{Convergència de la immersió}
Per la proposició \ref{prop:dos de tres}, sabem que la mètrica resultant del procés en el límit és la mètrica intrínseca de la varietat, com volíem. Ara bé, encara no hem demostrat que convergeixi en una immersió $C^1$. El primer que cal assegurar és que el resultat en el límit és, efectivament, una immersió. Amb aquest fi, podem imposar que en el pas $r$ de l'etapa $s$ del procés, el corresponent $B_3$ estigui fitat per
\begin{equation}\label{eq:b3_cota}
    B_{3} \le \frac1{2^{(s+r)}},
\end{equation}
de manera que la successió dels $B_3$ sigui més petita que els termes d'una sèrie convergent.

Imposant les mateixes fites per la successió de $B_2$, 
\begin{equation}
    B_2 \le \frac1{2^{(s+r)}},
\end{equation}
controlem els termes d'error d'ordre $O\left(\frac1{\lambda}\right)$ de l'equació \eqref{eq:moltes_lambdes}. Ara bé, per tal que les primeres derivades convergeixin al final del procés, cal que el terme irreductible $2\sqrt{K\beta_{ii}}$ també convergeixi.

\begin{prop}
    La sèrie formada per la successió $\set{2\sqrt{K\beta_{ii}}}_{\nu}$ convergeix per cada $i$ i uniformement en cada entorn $N_p$.
\end{prop}
{
\color{black} \textit{Prova.} 
$K$ és una constant que només depèn de la dimensió $n$ de la varietat, de manera que només ens hem d'ocupar de $\beta_{ii}$.
El tensor $\beta_{ij}$ aproxima l'error mètric $\delta_{ij}$, que es redueix per un factor $1/3$ o major després de cada etapa, com hem vist a la desigualtat \eqref{eq:delta_prima_cota}. Cal veure que $\beta_{ij}$ decreix de manera similar. Podem imposar que $\beta_{ij}$ sigui prou proper a $\delta_{ij}$ tal que 
\begin{equation}
    \frac{9}{10} \le \frac{\max|\beta_{ij}|_{N_p}}{\max|\delta_{ij}|_{N_p}} \le \frac{9}{8}.
\end{equation}
Aleshores,
\begin{equation}
    |\beta_{ij}'|_{N_p} \le \frac{9}{8}|\delta_{ij}'|_{N_p}\le \frac{9}{8}\frac{2}{3}|\delta_{ij}|_{N_p} \le \frac{9}{8}\frac{2}{3}\frac{10}{9}|\beta_{ij}|_{N_p} =  \frac{5}{6}|\beta_{ij}|_{N_p}.
\end{equation}
Així, el terme $\beta_{ii}$ decreix per un factor $5/6$ o major després de cada etapa. Per tant, la sèrie formada per la successió $\set{2\sqrt{K\beta_{ii}}}_{\nu}$ convergeix com una geomètrica de raó $\sqrt{5/6}$. \qed
}

\begin{obs}
    La conseqüència d'això és que, en el límit, la immersió $f$ és $C^1$, com volíem demostrar.
\end{obs}

\subsection{Encabiments isomètrics}

Fins ara hem estat tractant el cas de les immersions, per les quals no hi ha restricció pel que fa a les interseccions amb elles mateixes. Ara bé, per demostrar que el procés descrit per Nash també aplica als encabiments, que han de ser injectius, cal comprovar que les immersions resultants també ho són.

La demostració per encabiments és la mateixa que per immersions generals, però l'aplicació $f$ de la que partim ha de ser un encabiment. Si la varietat és oberta, demanem també que el conjunt límit, si existeix, no intersequi la imatge de l'encabiment. Un cop s'ha obtingut aquest primer encabiment curt, la única consideració addicional és que s'ha de controlar la mida de l'encabiment $|\overline z^\alpha - z^\alpha|$ en cada pas.

Ens haurem de fixar primer en què cada pas es pugui fer sense que el nou encabiment intersequi amb si mateix, i després en què l'encabiment resultant en el límit del procés sigui injectiu.
\begin{obs}
    Si la varietat és oberta, l'elecció de $B_3$ a \eqref{eq:b3_cota} assegura que el conjunt límit roman fix durant tot el procés.
\end{obs}
\begin{prop}
    En qualsevol pas d'una etapa i en qualsevol entorn $N_p$ de la frontera de l'encabiment, es pot escollir una $\lambda$ prou gran tal que el pas no produeixi interseccions de l'encabiment amb si mateix ni amb el conjunt límit.
\end{prop}
{
\color{black} \textit{Prova.} 
    Sigui $K$ un component compacte de l'encabiment que inclogui $N_p$ al seu interior. $K$, al seu torn, està inclòs en un entorn obert $H$ tan proper a $K$ tal que per qualsevol punt $P$ en $H$ no pot tenir dues perpendiculars a $K$ en $H$.

    Sigui $Q$ la unió de la frontera de l'encabiment i la part de l'encabiment que no està inclòs en $K$. Com $Q$ és un conjunt tancat, una pertorbació prou petita no pot intersecar $Q$. A més, com la pertorbació és normal a l'encabiment, estarà dins de $H$ i els punts de $K$ no es podran intersecar. Així doncs, el pas no produeix interseccions de l'encabiment amb si mateix ni amb el conjunt límit.\qed
}

Amb aquest resultat, obtenim per inducció que en qualsevol nombre finit de passos del procés, l'encabiment no produeix interseccions amb si mateix ni amb el conjunt límit. Això no assegura que el límit del procés sigui injectiu després d'infinits passos, sinó que cal considerar això a part.

\begin{prop}
    Es pot escollir una successió dels $B_3$ tal que el límit del procés sigui injectiu, és a dir, tal que la immersió resultant sigui un encabiment.
\end{prop}
{
\color{black} \textit{Prova.} 
    Considerem una enumeració dels $N_p$ qualsevol. Sigui $S_r$ el conjunt de tots els parells de punts dels primers $r$ entorns tals que estaven separats per una distància major que $2^{-r}$ en l'encabiment curt original. Qualsevol parell de punts pertany a $S_r$ per algun $r$. A partir de l'etapa $r$ requerirem que el $B_3$ de l'etapa $\mu\le r$ i el pas $\nu$ sigui més petit que $\varepsilon_r2^{-\mu-\nu}$, on $\varepsilon_r$ s'escull prou petit per assegurar que cap parell de punts pugui ajuntar-se al límit. D'aquesta manera, tots els parells de punts queden protegits en el límit, i la immersió resultant és un encabiment. \qed
}
\subsection{Obtenint la immersió o l'encabiment inicial}\label{sec:encabiment_inicial}
Amb tot el que hem demostrat fins aquí, ja hem vist que per qualsevol immersió o encabiment curt inicial $C^\infty$, es pot trobar una immersió o encabiment $C^1$ isomètric de la varietat en un espai euclidià. Només queda veure que es pot trobar aquesta immersió o aquest encabiment inicial. En aquesta subsecció expliquem el procés per obtenir-lo. 

En el cas d'una varietat tancada, podem obtenir l'encabiment inicial en $\mathbb R^{2n}$ mitjançant el teorema de Whitney. Per tal de fer-lo curt, només cal canviar l'escala de l'espai euclidià.
\begin{obs}
    El teorema de Whitney que hem demostrat en aquest treball, al teorema \ref{teo:whitney}, només ens assegura l'existència d'encabiments en espais de dimensió $2n+1$. Com hem mencionat allà, hi ha diferents formulacions del teorema de Whitney, amb la més forta assegurant l'existència d'encabiments en espais de dimensió $2n$.
\end{obs}

En el cas d'una varietat oberta, s'escull un recobriment per tancats $N_p$ i una partició de la unitat $\set{\varphi_p}$ subordinada a aquest recobriment, com abans, i denotem $x_{p_i}$ per la coordenada $i$-èssima de $N_p$. Suposem $|x_{p_i}|<1$ per a qualsevol $i$ i $p$. A més, imposem que cada $N_p$ interseca com a molt amb $s$ d'aquests conjunts, incloent-hi el mateix $N_p$. A continuació, separem els conjunts en $s$ classes, tals que cap conjunt té intersecció amb un altre de la mateixa classe. 

Construim un encabiment en un espai $s(n+2)$-dimensional $\mathbb R^{s(n+2)}$ amb les següents funcions:
\begin{equation}
    u_\sigma = 
    \begin{cases}
        \varepsilon_p\varphi_p & \text{en entorns $N_p$ de la classe $\sigma$} \\
        0 & \text{en la resta d'entorns}
    \end{cases}
\end{equation}
\begin{equation}
    v_\sigma = 
    \begin{cases}
        \varepsilon_p^2\varphi_p & \text{en entorns $N_p$ de la classe $\sigma$} \\
        0 & \text{en la resta d'entorns}
    \end{cases}
\end{equation}
\begin{equation}
    w_{\sigma i} = 
    \begin{cases}
        \varepsilon_p\varphi_p x_{p i} & \text{en entorns $N_p$ de la classe $\sigma$} \\
        0 & \text{en la resta d'entorns}
    \end{cases}
\end{equation}
on $\varepsilon_p$ formen part d'una successió monòtona decreixent i convergent a $0$. Qualsevol parell de punts de la varietat en entorns diferents es pot distingir per tenir diferents conjunts de raons $u_\sigma/v_\sigma$, i qualsevol parell de punts en el mateix entorn es pot distingir pels $w_{\sigma i}$ corresponents. A més, la frontera de l'encabiment és l'origen de coordenades.

Per últim, aquesta immersió es pot fer curta escollint els $\varepsilon_p$ tal que, si la immersió amb els $p$ primers entorns és curta per un factor $\frac13(2-1/p)$ o més gran, prenem $\varepsilon_{p+1}$ prou petit perquè la immersió amb $p+1$ primers entorns sigui curta per un factor $\frac13(2-1/(p+1))$ o més gran. 

Amb això obtenim un encabiment curt de classe $C^\infty$ de la varietat en un espai $s(n+2)$-dimensional. Mitjançant projeccions lineals com les de la demostració del teorema de Whitney, podem rebaixar la dimensió de l'espai de l'encabiment fins a $2n+1$, i fins a $2n$ per a immersions.

Amb això hem acabat la demostració del teorema de Nash.

\section{El refinament de Kuiper}
El fet que Nash utilitzi dos camps vectorials unitaris ortogonals entre ells i a la immersió en l'entorn $N_p$ restringeix severament la utilitat del seu resultat. En concret, per varietats Riemannianes de dimensió $2$, com l'esfera o el tor, el que ens interessa idealment és obtenir encabiments isomètrics en l'espai euclidià tridimensional, per tal de poder-les representar visualment, mentre que el resultat de Nash només ens permet construir encabiments isomètrics en un espai euclidià de dimensió $4$. 

En efecte, al final de l'article original, \cite{nash1954}, Nash mateix conjectura que és possible que el resultat es pugui refinar de tal manera que la codimensió de l'espai ambient sigui $1$ en lloc de $2$. Com hem mencionat a la introducció d'aquest capítol, Nicolaas H. Kuiper va demostrar aquest resultat l'any posterior a la publicació de Nash, de manera que acabem obtenint la següent formulació del teorema de Nash-Kuiper per encabiments $C^1$, \cite{kuiper1955}:

\begin{teo}[\textbf{Nash-Kuiper}]
    Qualsevol varietat Riemanniana tancada de dimensió $n$ té una immersió o encabiment $C^\infty$ en $\mathbb R^k$ amb $k\ge n+1$, aleshores també té una immersió o encabiment, respectivament, isomètric en $\mathbb R^k$.
\end{teo}

El mètode de Kuiper és molt similar al de Nash, però fa servir un tipus de pertorbació diferent, que anomenem \textbf{corrugació} (en anglès, \textit{strain}). Sigui $x^1$ la primera coordenada local de la varietat $M$, i $h_{ij}$ el tensor mètric induït per una primera immersió curta $C^\infty$ de la varietat en $\mathbb R^k$. Sigui $\eta$ un camp vectorial unitari normal a la imatge de la immersió, i $\xi$ el camp vectorial tangent tal que $\xi^\beta := \frac{\partial z^\beta}{\partial x^1}$, on $\set{z^\beta}$ és el sistema de coordenades de l'espai euclidià. Aleshores, la pertorbació de Kuiper és
\begin{equation*}
    \boxed{
        \overline{z}^\beta = z^\beta - \left(\frac{\overline \alpha^2}{8\lambda}\right)h\sin\left(2\lambda x^1\right)\xi^\beta + \left(\frac{\overline\alpha}{\lambda}\right)\sin\left(\lambda x^1 - \left(\frac{\overline\alpha ^2}{8}\right)\sin\left(2\lambda x^1\right)\right)h\eta^\beta,
        }
\end{equation*}
on $h$ és un valor derivat de la mètrica induïda tal que $h^2 = h_{11}$, $\overline\alpha = \alpha / \sqrt{h_{11}}$ amb $\alpha$ constant i  $\lambda$ és una constant que juga el mateix rol que a la pertorbació de Nash. Aquesta no és la única manera d'obtenir una pertorbació que arribi a un encabiment isomètric, sinó que es poden trobar altres mètodes que s'ajustin millor a la varietat concreta que es vulgui encabir.
\section{El naixement de la integració convexa}
El mètode de Nash-Kuiper per obtenir encabiments isometrics $C^1$ com a límits de successions d'encabiments curts $C^\infty$ mitjançant moviments oscil·lants d'alta freqüència va semblar una peculiaritat als matemàtics de l'època. Ara bé, el matemàtic rus Mikhaïl Gromov va prendre l'essència d'aquesta mena de demostracions i les va generalitzar, formalitzar i unificar sota el concepte de la \textbf{integració convexa}. A grans trets, la integració convexa consisteix en trobar solucions formals a certes relacions diferencials parcials i deformar-les per trobar solucions geomètriques reals, si aquestes relacions diferencials parcials verifiquen un criteri de flexibilitat anomenat el principi $h$.

Al següent capítol veurem un encabiment isomètric $C^1$ del tor en $\mathbb R^3$ que no seguirà al peu de la lletra els mètodes de Nash ni de Kuiper, sinó que tractarà el problema amb el llenguatge general de la integració convexa. 